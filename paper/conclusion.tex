\section{Discussion}
    The two algorithms for multi-modal image registration presented in this work reduce the multi-modal problem to the mono-modal case by assuming the existence of two transfer functions between the two modalities. SyN-EM uses the voxel-wise metric proposed by Arce {\it et al.}~\cite{Arce-santana2014}, which generalizes the correlation ratio \cite{Roche1998}. The main novelty introduced with the SyN-EM algorithm consists in modeling the registration problem symmetrically (eq. \eqref{eq:SyNEM_gom_ref}), which allows us to use both transfer functions instead of selecting one of them arbitrarily. By using the EM algorithm to optimize the deformation field and transfer functions according to this symmetric model, we naturally obtain an extension of the greedy symmetric normalization algorithm (greedy SyN) developed by Avants {\it et al.}~\cite{Avants2008} \cite{Avants2011}, which may be regarded as a Generalized EM algorithm (GEM), in which the energy is not fully optimized at each step with respect to the transformations $\phi_{I}, \phi_{J}$, but only reduced at each iteration, this can be seen in lines 9 and 10 of algorithm \ref{alg:SyNEM}, corresponding to eq. \eqref{eq:euler_lagrange_step1}, which are approximated minimizers of eq. \eqref{eq:vercauteren_cost}. It can also be seen in line 6 of algorithm \ref{alg:Greedy_SyN} (the standard greedy SyN algorithm) and lines 9 and 10 of algorithm \ref{alg:SyNECC} (the proposed SyN-ECC) algorithm, in which only a step in the direction of the negative gradient is made. It has been shown that a full optimization in the M step is not necessary, and a local maximum of the likelihood is still reached with partial optimizations \cite{Neal1998}. The aspect that, to the best of our knowledge, has not been fully studied regarding the greedy SyN algorithm are the displacement field inversions in lines 7, 8 of algorithm \ref{alg:Greedy_SyN} and 13, 14 of algorithms \ref{alg:SyNEM} and \ref{alg:SyNECC}, which may be regarded as projections to the space of diffeomorphisms. Technically, it would be necessary to show that the two inversions effectively produce the projection of the updated displacement field to the space of diffeomorphisms, that way the optimization process of SyN might be interpreted as a gradient projection method \cite{Xiu2007}. We decided to use greedy SyN as the basis of our algorithms because it has consistently been proven to be very accurate and efficient \cite{Klein2009} \cite{Klein2010} \cite{Rohlfing2012}, but a more rigorous study of the optimization aspects of the SyN algorithm is beyond the scope of this work, and we leave it as subject for future research.\\
    
    The validation protocol proposed in this worked allows us to quantitatively assess the accuracy of multi-modal registration algorithms under realistic conditions for three different image modalities and their combinations: T1, T2 and PD. To perform this evaluation, it was necessary to perform 2,754 registrations for each of the 4 methods under evaluation (a total of 11,016 registrations), which we consider a fairly strong validation. Still, we did not exploit the full potential of this validation protocol: it is also possible to study the performance of the same multi-modal registration algorithms in the presence of noise and spatial inhomogeneities, since the Brainweb template allows us to realistically simulate this kind of distortions. A more comprehensive comparison of other available non-linear multi-modal algorithms including these artifacts is also a subject for future research.
    

\section{Conclusion}
We presented two algorithms for Symmetric Diffeomorphic Registration for multi-modal images: SyN-EM and SyN-ECC. The first algorithm is an extension of the algorithm recently proposed by Arce-Santana {\it et al.}~\cite{Arce-santana2014} under the (asymmetric) elastic registration framework and we extended it in this work to take advantage of both modalities under the Symmetric Diffeomorphic Registration framework developed by Avants {\it et al.}~\cite{Avants2008} \cite{Avants2011}. The second algorithm is an extension of the Cross-Correlation metric for multi-modal images. We evaluated our algorithms using the publicly available IBSR database following the methodology of Klein {\it et al.}~\cite{Klein2009} \cite{Klein2010} and
Rohlfing \cite{Rohlfing2012} to show that both algorithms are competitive for mono-modal image registration, even though they were designed for multi-modal registration.
To evaluate the performance of our algorithms in a realistic, controlled, multi-modal registration experiment we used the Brainweb \cite{Cocosco1997}\cite{Kwan1999} template
to generate synthetic T2 images for each of the IBSR T1 volumes. Experiments show that the CC metric is dramatically affected by the change of modality while the performance of
SyN-EM and SyN-CC remains comparable to the mono-modal case.\\

To the best of our knowledge, prior to this work, the only publicly available algorithm for Multi-Modal Symmetric Diffeomorphic Registration was driven by the Mutual Information
metric and we show that our algorithms compare favourably against the reference implementation provided by the ANTS software. We made our algorithms
publicly available in Dipy \cite{Garyfallidis2014}. SyN-EM will be available in Dipy 0.8 and SyN-ECC in Dipy 0.9.
